<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Score Details - Flight Booking Simulator</title>
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: #e5e7eb;
        padding: 40px 20px;
    }

    .back-link {
        display: inline-block;
        color: #2563eb;
        text-decoration: none;
        font-weight: 600;
        margin-bottom: 20px;
        font-size: 15px;
    }

    .back-link:hover {
        text-decoration: underline;
    }

    .container {
        max-width: 1400px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
    }

    /* Left Panel - Student Response */
    .student-panel {
        background: #ffffff;
        border: 3px solid #000;
        border-radius: 0;
        padding: 0;
        box-shadow: 8px 8px 0 rgba(0,0,0,0.1);
    }

    .student-header {
        padding: 24px;
        border-bottom: 2px solid #e5e7eb;
    }

    .student-profile {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
    }

    .profile-left {
        display: flex;
        align-items: center;
        gap: 16px;
    }

    .student-avatar {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background-color: #d1d5db;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .student-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .student-info {
        flex: 1;
    }

    .student-name {
        font-size: 18px;
        font-weight: 700;
        color: #000;
        margin-bottom: 2px;
    }

    .student-id {
        font-size: 13px;
        color: #6b7280;
    }

    .score-badge {
        background: #fff;
        border: 2px solid #000;
        padding: 6px 14px;
        font-size: 14px;
        font-weight: 700;
        color: #000;
        white-space: nowrap;
    }

    .activity-section {
        background: #0f766e;
        padding: 16px 24px;
        display: flex;
        align-items: center;
        gap: 14px;
    }

    .activity-icon-box {
        width: 48px;
        height: 48px;
        background: #fff;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
    }

    .activity-info {
        color: #fff;
    }

    .activity-title {
        font-size: 20px;
        font-weight: 700;
        margin-bottom: 2px;
    }

    .activity-date {
        font-size: 13px;
        opacity: 0.9;
    }

    .student-content {
        padding: 24px;
    }

    .no-submission {
        text-align: center;
        padding: 60px 20px;
        color: #6b7280;
    }

    .no-submission-icon {
        font-size: 60px;
        margin-bottom: 16px;
    }

    .no-submission-title {
        font-size: 18px;
        font-weight: 600;
        color: #374151;
        margin-bottom: 8px;
    }

    .no-submission-text {
        font-size: 14px;
    }

    .field-group {
        margin-bottom: 20px;
    }

    .field-row {
        display: flex;
        gap: 40px;
        margin-bottom: 20px;
    }

    .field-item {
        flex: 1;
    }

    .field-label {
        font-size: 13px;
        font-weight: 600;
        color: #000;
        margin-bottom: 6px;
        display: flex;
        align-items: center;
        gap: 6px;
    }

    .field-value {
        font-size: 15px;
        color: #000;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .check-icon {
        font-size: 16px;
        font-weight: bold;
    }

    .check-icon.correct { color: #10b981; }
    .check-icon.incorrect { color: #ef4444; }

    .route-box {
        background: #fef3c7;
        border-left: 4px solid #fbbf24;
        padding: 14px;
        margin-top: 8px;
    }

    .route-box.correct {
        background: #d1fae5;
        border-left-color: #10b981;
    }

    .route-box.incorrect {
        background: #fee2e2;
        border-left-color: #ef4444;
    }

    .route-code {
        font-size: 15px;
        font-weight: 700;
        color: #000;
        margin-bottom: 6px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .route-code.incorrect {
        color: #ef4444;
    }

    .route-date {
        font-size: 13px;
        color: #6b7280;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .route-date.incorrect {
        color: #ef4444;
    }

    .passenger-btn {
        width: 100%;
        background: #065f46;
        color: #fff;
        border: none;
        padding: 10px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        margin-bottom: 16px;
        border-radius: 0;
    }

    .passenger-btn:hover {
        background: #064e3b;
    }

    .passenger-card {
        background: #fff;
        border: 2px solid #e5e7eb;
        padding: 14px;
        margin-bottom: 12px;
        border-radius: 0;
    }

    .passenger-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
        flex-wrap: wrap;
        gap: 8px;
    }

    .passenger-name {
        font-size: 14px;
        font-weight: 700;
        color: #000;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .passenger-badges {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .badge {
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 600;
    }

    .badge.pwd {
        background: #fee2e2;
        color: #991b1b;
    }

    .badge.declaration {
        background: #d1fae5;
        color: #065f46;
    }

    .passenger-details {
        font-size: 13px;
        color: #4b5563;
        line-height: 1.8;
    }

    /* Right Panel - Task/Expected Answer */
    .task-panel {
        background: #ffffff;
        border: 3px solid #000;
        border-radius: 0;
        padding: 0;
        box-shadow: 8px 8px 0 rgba(0,0,0,0.1);
    }

    .task-header {
        padding: 24px;
        border-bottom: 2px solid #e5e7eb;
    }

    .task-title-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
    }

    .task-title {
        font-size: 24px;
        font-weight: 700;
        color: #000;
    }

    .points-badge {
        font-size: 16px;
        font-weight: 700;
        color: #000;
    }

    .task-date {
        font-size: 13px;
        color: #6b7280;
    }

    .task-info-section {
        background: #0d9488;
        padding: 16px 24px;
        color: #fff;
    }

    .task-info-title {
        font-size: 15px;
        font-weight: 600;
        margin-bottom: 8px;
    }

    .task-info-row {
        display: flex;
        gap: 40px;
        font-size: 14px;
    }

    .task-content {
        padding: 24px;
    }

    .task-route-box {
        background: #f0fdfa;
        border-left: 4px solid #0f766e;
        padding: 14px;
        margin-top: 8px;
    }

    .task-route-code {
        font-size: 15px;
        font-weight: 700;
        color: #0f766e;
        margin-bottom: 6px;
    }

    .task-route-date {
        font-size: 13px;
        color: #115e59;
    }

    .passenger-info-btn {
        width: 100%;
        background: #0d9488;
        color: #fff;
        border: none;
        padding: 10px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        margin-top: 12px;
        margin-bottom: 16px;
        border-radius: 0;
    }

    .passenger-info-btn:hover {
        background: #0f766e;
    }

    .expected-passenger-card {
        background: #f9fafb;
        border: 2px solid #e5e7eb;
        padding: 14px;
        margin-bottom: 12px;
        border-radius: 0;
    }

    .expected-passenger-name {
        font-size: 14px;
        font-weight: 700;
        color: #000;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 8px;
        flex-wrap: wrap;
    }

    @media (max-width: 1024px) {
        .container {
            grid-template-columns: 1fr;
        }
    }
</style>
</head>
<body>

<!-- Back Link -->
<a href="{% url 'student_grade' %}?task={{ task_booking.id }}&section={{ section.pk }}&task_number={{ task_number }}" class="back-link">
    ‚Üê Back to Student List
</a>

<div class="container">
    <!-- LEFT PANEL: STUDENT SUBMISSION -->
    <div class="student-panel">
        <!-- Student Header -->
        <div class="student-header">
            <div class="student-profile">
                <div class="profile-left">
                    <div class="student-avatar">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%23d1d5db'/%3E%3Ccircle cx='50' cy='40' r='18' fill='%239ca3af'/%3E%3Cellipse cx='50' cy='85' rx='30' ry='25' fill='%239ca3af'/%3E%3C/svg%3E" alt="Student">
                    </div>
                    <div class="student-info">
                        <div class="student-name">{{ student_name|default:"Veryljeb Bada" }}</div>
                        <div class="student-id">{{ student_number|default:"2021-0314" }}</div>
                    </div>
                </div>
                <div class="score-badge">Score: {{ student_total_score|floatformat:0|default:"0" }}/{{ total_max_score|floatformat:0|default:"100" }} points</div>
            </div>
        </div>

        <!-- Activity Section -->
        <div class="activity-section">
            <div class="activity-icon-box">üìã</div>
            <div class="activity-info">
                <div class="activity-title">{{ task_name|default:"Task 5" }}</div>
                <div class="activity-date">
                    {% if student_booking %}
                        {{ student_booking.created_at|date:"g:ia - M d, Y"|default:"Not submitted" }}
                    {% else %}
                        Not submitted
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Student Content -->
        <div class="student-content">
            {% if student_booking %}
                <!-- Trip Type and Class -->
                <div class="field-row">
                    <div class="field-item">
                        <div class="field-label">Trip type:</div>
                        <div class="field-value">
                            {{ student_booking.trip_type|default:"One way" }}
                            {% if field_comparisons.trip_type.match %}
                                <span class="check-icon correct">‚úì</span>
                            {% else %}
                                <span class="check-icon incorrect">‚úó</span>
                            {% endif %}
                        </div>
                    </div>
                    <div class="field-item">
                        <div class="field-label">Class:</div>
                        <div class="field-value">
                            {{ student_booking.travel_class|default:"Economy" }}
                            {% if field_comparisons.travel_class.match %}
                                <span class="check-icon correct">‚úì</span>
                            {% else %}
                                <span class="check-icon incorrect">‚úó</span>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Route Details -->
                <div class="field-group">
                    <div class="field-label">
                        Route Details
                        {% if field_comparisons.route.match %}
                            <span class="check-icon correct">‚úì</span>
                        {% else %}
                            <span class="check-icon incorrect">‚úó</span>
                        {% endif %}
                    </div>
                    <div class="route-box {% if field_comparisons.route.match %}correct{% else %}incorrect{% endif %}">
                        <div class="route-code {% if not field_comparisons.route.match %}incorrect{% endif %}">
                            {{ route_display_student|default:"MNL - CEB" }}
                            {% if not field_comparisons.route.match %}
                                <span class="check-icon incorrect">‚úó</span>
                            {% endif %}
                        </div>
                        {% if student_booking.departure_date %}
                        <div class="route-date {% if not field_comparisons.departure_date.match %}incorrect{% endif %}">
                            Departure: {{ student_booking.departure_date|date:"j M Y"|default:"5 Oct 2025" }}
                            {% if not field_comparisons.departure_date.match %}
                                <span class="check-icon incorrect">‚úó</span>
                            {% endif %}
                        </div>
                        {% else %}
                        <div class="route-date incorrect">
                            Departure: 5 Oct 2025
                            <span class="check-icon incorrect">‚úó</span>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Passengers Count -->
                <div class="field-row" style="margin-top: 20px;">
                    <div class="field-item">
                        <div class="field-label">Adults:</div>
                        <div class="field-value">
                            {{ student_booking.adults|default:"1" }}
                            {% if field_comparisons.adults.match %}
                                <span class="check-icon correct">‚úì</span>
                            {% else %}
                                <span class="check-icon incorrect">‚úó</span>
                            {% endif %}
                        </div>
                    </div>
                    <div class="field-item">
                        <div class="field-label">Children:</div>
                        <div class="field-value">
                            {{ student_booking.children|default:"0" }}
                            {% if field_comparisons.children.match %}
                                <span class="check-icon correct">‚úì</span>
                            {% else %}
                                <span class="check-icon incorrect">‚úó</span>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Seat Preference -->
                <div class="field-group">
                    <div class="field-label">Seat Preference:</div>
                    <div class="field-value">
                        {{ student_booking.seat_preference|default:"aisle" }}
                        {% if field_comparisons.seat_preference.match %}
                            <span class="check-icon correct">‚úì</span>
                        {% else %}
                            <span class="check-icon incorrect">‚úó</span>
                        {% endif %}
                    </div>
                </div>

                <!-- Passenger Details Button -->
                <button class="passenger-btn">Passenger Details</button>

                <!-- Passenger Cards -->
                {% if passenger_comparisons %}
                    {% for comparison in passenger_comparisons %}
                    {% if comparison.student %}
                    <div class="passenger-card">
                        <div class="passenger-header">
                            <div class="passenger-name">
                                {{ comparison.student.title|default:"Mr." }} {{ comparison.student.first_name|default:"Christian John" }} {% if comparison.student.middle_initial %}{{ comparison.student.middle_initial }}.{% endif %} {{ comparison.student.last_name|default:"G. Teofilo" }}
                                {% if comparison.name_match %}
                                    <span class="check-icon correct">‚úì</span>
                                {% else %}
                                    <span class="check-icon incorrect">‚úó</span>
                                {% endif %}
                            </div>
                            <div class="passenger-badges">
                                {% if comparison.student.is_pwd %}
                                    <span class="badge pwd">üßë‚Äçü¶Ω PWD</span>
                                {% endif %}
                                {% if comparison.student.has_declaration %}
                                    <span class="badge declaration">‚úì Declaration</span>
                                {% endif %}
                                {% if not comparison.badges_match %}
                                    <span class="check-icon incorrect">‚úó</span>
                                {% endif %}
                            </div>
                        </div>
                        <div class="passenger-details">
                            DOB: {{ comparison.student.dob|date:"M d, Y"|default:"Dec 25, 2002" }} | Nationality: {{ comparison.student.nationality|default:"Filipino" }}
                            {% if comparison.dob_match and comparison.nationality_match %}
                                <span class="check-icon correct">‚úì</span>
                            {% else %}
                                <span class="check-icon incorrect">‚úó</span>
                            {% endif %}
                            <br>
                            Passport: {{ comparison.student.passport|default:"987654" }}
                            {% if comparison.passport_match %}
                                <span class="check-icon correct">‚úì</span>
                            {% else %}
                                <span class="check-icon incorrect">‚úó</span>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                    {% endfor %}
                {% else %}
                    <!-- Dummy Data Example -->
                    <div class="passenger-card">
                        <div class="passenger-header">
                            <div class="passenger-name">
                                Mr. Christian John Teofilo
                                <span class="check-icon incorrect">‚úó</span>
                            </div>
                            <div class="passenger-badges">
                                <span class="badge pwd">üßë‚Äçü¶Ω PWD</span>
                                <span class="check-icon incorrect">‚úó</span>
                            </div>
                        </div>
                        <div class="passenger-details">
                            DOB: Dec 25, 2002 | Nationality: Filipino <span class="check-icon correct">‚úì</span><br>
                            Passport: 987654 <span class="check-icon incorrect">‚úó</span>
                        </div>
                    </div>
                {% endif %}

            {% else %}
                <!-- No Submission -->
                <div class="no-submission">
                    <div class="no-submission-icon">üì≠</div>
                    <div class="no-submission-title">No Submission Yet</div>
                    <div class="no-submission-text">This student hasn't submitted this task.</div>
                </div>
            {% endif %}
        </div>
    </div>













    
    <!-- RIGHT PANEL: EXPECTED ANSWER -->
    <div class="task-panel">
        <!-- Task Header -->
        <div class="task-header">
            <div class="task-title-row">
                <div class="task-title">{{ task_name|default:"Task 5" }}</div>
                <div class="points-badge">{{ total_max_score|floatformat:0|default:"100" }} points</div>
            </div>
            <div class="task-date">12:49pm - Jan 13, 2025</div>
        </div>

        <!-- Task Info Section -->
        <div class="task-info-section">
            <div class="task-info-title">Trip Information</div>
            <div class="task-info-row">
                <div><strong>Trip type:</strong> {{ task_booking.trip_type }}</div>
                <div><strong>Class:</strong> {{ task_booking.travel_class }}</div>
            </div>
        </div>

        <!-- Task Content -->
        <div class="task-content">
            <!-- Route Details -->
            <div class="field-group">
                <div class="field-label">Route Details</div>
                <div class="task-route-box">
                    <div class="task-route-code">{{ route_display_task }}</div>
                    {% if task_booking.departure_date %}
                    <div class="task-route-date">Departure: {{ task_booking.departure_date|date:"j M Y" }}</div>
                    {% endif %}
                    {% if task_booking.return_date %}
                    <div class="task-route-date">Return: {{ task_booking.return_date|date:"j M Y" }}</div>
                    {% endif %}
                </div>
            </div>

            <!-- Passengers Count -->
            <div class="field-group" style="margin-top: 20px;">
                <div class="field-label">Adults: <span style="font-weight: normal;">{{ task_booking.adults }}</span></div>
                <div class="field-label">Children: <span style="font-weight: normal;">{{ task_booking.children }}</span></div>
            </div>

            <!-- Seat Preference -->
            <div class="field-group">
                <div class="field-label">Seat Preference: <span style="font-weight: normal;">{{ task_booking.seat_preference }}</span></div>
            </div>

            <!-- Passenger Details Button -->
            <button class="passenger-info-btn">Passenger Details</button>

            <!-- Expected Passenger Cards -->
            {% if task_booking.passengers.exists %}
                {% for passenger in task_booking.passengers.all %}
                <div class="expected-passenger-card">
                    <div class="expected-passenger-name">
                        {{ passenger.title }} {{ passenger.first_name }} {% if passenger.middle_initial %}{{ passenger.middle_initial }}.{% endif %} {{ passenger.last_name }}
                        {% if passenger.has_declaration %}
                            <span class="badge declaration">‚úì Declaration</span>
                        {% endif %}
                        {% if passenger.is_pwd %}
                            <span class="badge pwd">üßë‚Äçü¶Ω PWD</span>
                        {% endif %}
                    </div>
                    <div class="passenger-details">
                        DOB: {{ passenger.dob|date:"M d, Y" }} | Nationality: {{ passenger.nationality }}<br>
                        Passport: {{ passenger.passport }}
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <p style="font-size: 14px; color: #6b7280;">No expected passenger details found.</p>
            {% endif %}
        </div>
    </div>
</div>

</body>
</html>