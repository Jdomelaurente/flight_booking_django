{% extends 'booking/base.html' %}
{% load static %}   {# <-- THIS LINE IS REQUIRED #}

{% block title %} Payment {% endblock %}

{% block content %}
<main class="mx-auto flex flex-col items-center py-10">

    <!-- Display any messages -->
    {% if messages %}
        <div class="mb-4">
            {% for message in messages %}
            <div class="p-3 rounded {% if message.tags == 'error' %}bg-red-100 text-red-700{% else %}bg-green-100 text-green-700{% endif %}">
                {{ message }}
            </div>
            {% endfor %}
        </div>
    {% endif %}

    <h1 class="text-3xl font-bold mb-8">Choose Payment Method (Temporary)</h1>

    <div class="mb-4">
        <p class="text-lg font-semibold">Total Amount: <span class="text-[#2975F7]">â‚±{{ total_amount|floatformat:2 }}</span></p>
        <p class="text-sm text-gray-600">Booking Reference: #{{ booking.id }}</p>
    </div>

    <!-- Payment Method Form -->
    <form action="{% url 'bookingapp:payment_method' %}" method="POST">
        {% csrf_token %}
        
        <div class="space-y-4 mb-6">
            <h3 class="font-semibold text-gray-700">Select Payment Method:</h3>
            
            {% for method_value, method_name in payment_methods %}
            <div class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                <input type="radio" id="method_{{ method_value }}" name="payment_method" value="{{ method_value }}" 
                        class="h-4 w-4 text-[#2975F7] focus:ring-[#2975F7]" 
                        {% if forloop.first %}checked{% endif %} required>
                <label for="method_{{ method_value }}" class="ml-3 block text-sm font-medium text-gray-700 cursor-pointer">
                    {{ method_name }}
                </label>
            </div>
            {% endfor %}
        </div>

        <div class="flex space-x-4">
            <a href="{% url 'bookingapp:booking_summary' %}" 
                class="flex-1 text-center bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-semibold transition">
                Back
            </a>
            <button type="submit" 
                    class="flex-1 bg-[#2975F7] hover:bg-[#2975F7]/90 text-white px-6 py-3 rounded-lg font-semibold transition">
                Confirm Payment
            </button>
        </div>
    </form>

</main>

<script>
    // Make the whole card clickable
    document.querySelectorAll('.payment-option').forEach(option => {
        option.addEventListener('click', () => {
            option.querySelector('input[type="radio"]').checked = true;
            document.querySelectorAll('.payment-option').forEach(o => o.classList.remove('border-yellow-500'));
            option.classList.add('border-yellow-500');
        });
    });
</script>
{% endblock %}
