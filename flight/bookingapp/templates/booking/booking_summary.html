{% extends 'booking/base.html' %}
{% block title %} Booking Summary {% endblock %}

{% block content %}
{% load static %}

<main class="mx-auto flex flex-col justify-center space-y-8 py-6">

    <!-- Step Indicator (Same style as your existing design) -->
            <!-- stepbystep -->
        <div class="bg-[#F4EB08]  mx-auto h-[100px] w-[1100px] shadow-md/50 rounded-[20px] flex flex-col">
            <!-- arrow  -->
            <div class="flex justify-between items-center flex-1 mx-20">
                <div class="   rounded-full p-1 border border-[#2975F7]">
                    <svg  xmlns="http://www.w3.org/2000/svg" width="22" height="22"  class="bg-[#2975F7] p-1 rounded-full"
                        fill="white" viewBox="0 0 24 24" >
                        <path d="m17.54,3.64l-2.9,2.9-9.88-1.16c-.15-.02-.3.03-.41.14l-.59.59c-.24.24-.17.66.14.8l7.01,3.36-3.25,3.25-3.27-.65c-.16-.03-.33.02-.45.14l-.7.7c-.25.25-.17.67.16.81l4.27,1.83,1.83,4.27c.14.33.56.41.81.16l.7-.7c.12-.12.17-.29.14-.45l-.65-3.27,3.31-3.31,3.31,7.06c.15.31.56.39.81.14l.66-.66c.11-.11.16-.26.14-.41l-1.16-9.88,2.75-2.75c.7-.7.88-1.84.29-2.65-.74-1.03-2.19-1.12-3.05-.26Z"></path>
                    </svg>
                </div>

                <div class="flex-1 border text-white"></div>

                <div class="   rounded-full p-1 border border-[#2975F7]">
                   <svg  xmlns="http://www.w3.org/2000/svg" width="22" height="22"  class="bg-[#2975F7] p-1 rounded-full"
                        fill="white" viewBox="0 0 24 24" >
                        <!--Boxicons v3.0 https://boxicons.com | License  https://docs.boxicons.com/free-->
                        <path d="m19,2H5c-.55,0-1,.45-1,1v4h-2v2h2v2h-2v2h2v2h-2v2h2v4c0,.55.45,1,1,1h14c1.1,0,2-.9,2-2V4c0-1.1-.9-2-2-2Zm-6.5,5c1.43,0,2.5,1.07,2.5,2.5s-1.07,2.5-2.5,2.5-2.5-1.07-2.5-2.5,1.07-2.5,2.5-2.5Zm4.5,10h-9v-1c0-1.66,1.34-3,3-3h3c1.66,0,3,1.34,3,3v1Z"></path>
                    </svg>
                </div>

                <div class="flex-1 border text-white"></div>

                <div class="   rounded-full p-1 border border-[#2975F7]">
                    <svg  xmlns="http://www.w3.org/2000/svg" width="22" height="22"   class="bg-[#2975F7] p-1 rounded-full"
                        fill="white" viewBox="0 0 24 24" >
                        <!--Boxicons v3.0 https://boxicons.com | License  https://docs.boxicons.com/free-->
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4z"></path>
                    </svg>
                </div>

                <div class="flex-1 border text-white"></div>

                <div class="   rounded-full p-1 border border-[#2975F7]">
                    <svg  xmlns="http://www.w3.org/2000/svg" width="22" height="22"  class="bg-[#2975F7] p-1 rounded-full"
                        fill="white" viewBox="0 0 24 24" >
                        <!--Boxicons v3.0 https://boxicons.com | License  https://docs.boxicons.com/free-->
                        <path d="m4,5v4h2v-4h4v-2h-4c-1.1,0-2,.9-2,2Z"></path><path d="m6,15h-2v4c0,1.1.9,2,2,2h4v-2h-4v-4Z"></path><path d="m20,19h-4v2h4c1.1,0,2-.9,2-2v-4h-2v4Z"></path><path d="m16,3v2h4v4h2v-4c0-1.1-.9-2-2-2h-4Z"></path><path d="M8 15H18V17H8z"></path><path d="M18 7 8 7 8 11 3 11 3 13 8 13 18 13 23 13 23 11 18 11 18 7z"></path>
                    </svg>
                </div>

                <div class="flex-1 border text-white"></div>

                <div class="   rounded-full p-1 border border-[#2975F7]">
                    <svg  xmlns="http://www.w3.org/2000/svg" width="22" height="22"  class="bg-[#2975F7] p-1 rounded-full"
                        fill="white" viewBox="0 0 24 24" >
                        <!--Boxicons v3.0 https://boxicons.com | License  https://docs.boxicons.com/free-->
                        <path d="m21,7h-1v-3c0-.55-.45-1-1-1H5c-1.65,0-3,1.35-3,3v12c0,2.2,1.79,3,3,3h16c.55,0,1-.45,1-1v-12c0-.55-.45-1-1-1Zm-3,9h-2v-4h2v4ZM5,5h13v2H5c-.55,0-1-.45-1-1s.45-1,1-1Z"></path>
                    </svg>
                </div>

                <div class="flex-1 border text-white"></div>

                <div class="   rounded-full p-1 border border-[#2975F7]">
                    <svg  xmlns="http://www.w3.org/2000/svg" width="22" height="22"   class="bg-[#2975F7] p-1 rounded-full"
                        fill="white" viewBox="0 0 24 24" >
                        <!--Boxicons v3.0 https://boxicons.com | License  https://docs.boxicons.com/free-->
                        <path d="M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2m-1.29 13.71c-.2.2-.45.29-.71.29s-.51-.1-.71-.29l-3-3L7.7 11.3l2.29 2.29 5.29-5.29 1.41 1.41-6 6Z"></path>
                    </svg>
                </div>

            </div>

            <!-- label  -->
             <div></div>

        </div>

         <div class="flex w-full flex-1 flex-col mx-auto max-w-[1200px] mt-5 space-y-5">
            <div class="flex flex-1">
                 <svg  xmlns="http://www.w3.org/2000/svg" width="38" height="38"  
                    fill="#NaNNaNNaN" viewBox="0 0 24 24" >
                    <!--Boxicons v3.0 https://boxicons.com | License  https://docs.boxicons.com/free-->
                    <path d="m19,2H5c-.55,0-1,.45-1,1v4h-2v2h2v2h-2v2h2v2h-2v2h2v4c0,.55.45,1,1,1h14c1.1,0,2-.9,2-2V4c0-1.1-.9-2-2-2Zm0,18H6V4h13v16Z"></path><path d="M12.5 7A2.5 2.5 0 1 0 12.5 12 2.5 2.5 0 1 0 12.5 7z"></path><path d="m17,16c0-1.66-1.34-3-3-3h-3c-1.66,0-3,1.34-3,3v1h9v-1Z"></path>
                </svg>
                <div>
                    <h1 class="text-3xl  font-bold flex leading-none">
                        Booking Summary</h1>
                    <p class="text-xs text-gray-500">Review your booking before proceeding to payment</p>
                </div>
               
            </div>
        </div>    


        <!-- Booking Summary Card -->
        <div class="flex justify-center items-center flex-col space-y-3">
            <!-- Booking Summary Container -->
        <div class="flex justify-center items-start flex-col lg:flex-row gap-5">

            <!-- Left Section: Flight + Passengers -->
            <div class="w-[1000px] lg:w-2/3 space-y-6">

                <!-- Flight Information -->
                <div class="bg-white rounded-xl shadow-md/50 p-6 space-y-4">
                    <h2 class="text-lg font-bold text-[#2975F7] flex items-center gap-2">
                        Flight Information
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        {% if depart_schedule %}
                        <div class="border rounded-md p-4 bg-gray-50">
                            <h3 class="font-semibold text-gray-700 mb-2">Departure Flight</h3>
                            <p><span class="font-semibold">Flight:</span> {{ depart_schedule.flight }}</p>
                            <p><span class="font-semibold">From:</span> {{ depart_schedule.flight.route.origin_airport }}</p>
                            <p><span class="font-semibold">To:</span> {{ depart_schedule.flight.route.destination_airport }}</p>
                            <p><span class="font-semibold">Departure:</span> {{ depart_schedule.departure_time|date:"d M Y, h:i A" }}</p>
                            <p><span class="font-semibold">Price:</span> ₱{{ depart_schedule.price|floatformat:2 }}</p>
                        </div>
                        {% endif %}

                        {% if return_schedule %}
                        <div class="border rounded-md p-4 bg-gray-50">
                            <h3 class="font-semibold text-gray-700 mb-2">Return Flight</h3>
                            <p><span class="font-semibold">Flight:</span> {{ return_schedule.flight }}</p>
                            <p><span class="font-semibold">From:</span> {{ return_schedule.flight.route.origin_airport }}</p>
                            <p><span class="font-semibold">To:</span> {{ return_schedule.flight.route.destination_airport }}</p>
                            <p><span class="font-semibold">Departure:</span> {{ return_schedule.departure_time|date:"d M Y, h:i A" }}</p>
                            <p><span class="font-semibold">Price:</span> ₱{{ return_schedule.price|floatformat:2 }}</p>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Passengers -->
                <div class="bg-white rounded-xl shadow-md/50 p-8 space-y-2">
                    <h2 class="text-lg font-bold text-[#2975F7]"> Passengers</h2>
                    <div class="overflow-x-auto">
                        <table class="min-w-full  rounded-lg text-sm">
                            <thead class="bg-[#F4EB08] text-gray-800 uppercase text-[10px]">
                                <tr>
                                    <th class="px-3 py-2">#</th>
                                    <th class="px-3 py-2">Name</th>
                                    <th class="px-3 py-2">Depart Seat</th>
                                    <th class="px-3 py-2">Return Seat</th>
                                    <th class="px-3 py-2">Gender</th>
                                    <th class="px-3 py-2">DOB</th>
                                    <th class="px-3 py-2">Passport</th>
                                    <th class="px-3 py-2">Nationality</th>
                                    <th class="px-3 py-2"></th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for p in passengers %}
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="px-3 py-2">{{ forloop.counter }}</td>
                                    <td class="px-3 py-2">{{ p.full_name }}</td>
                                    <td class="px-3 py-2">{{ p.depart_seat }}</td>
                                    <td class="px-3 py-2">{{ p.return_seat }}</td>
                                    <td class="px-3 py-2">{{ p.gender }}</td>
                                    <td class="px-3 py-2">{{ p.dob }}</td>
                                    <td class="px-3 py-2">{{ p.passport }}</td>
                                    <td class="px-3 py-2">{{ p.nationality }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Right Section: Price + Contact -->
            <div class="w-full lg:w-1/3 space-y-6">

                <!-- Price Summary -->
                <div class="bg-white rounded-xl shadow-md/50 p-6 space-y-3">
                    <h2 class="text-xl font-bold text-[#2975F7]"> Price Summary</h2>
                    <div class="flex justify-between text-gray-700">
                        <span>Price per passenger:</span>
                        <span>₱{{ price_per_passenger|floatformat:2 }}</span>
                    </div>
                    <div class="flex justify-between text-gray-700">
                        <span>Number of passengers:</span>
                        <span>{{ num_passengers }}</span>
                    </div>
                    <div class="flex justify-between text-gray-700">
                        <span>Subtotal:</span>
                        <span>₱{{ subtotal|floatformat:2 }}</span>
                    </div>
                    <div class="flex justify-between text-gray-700">
                        <span>Taxes:</span>
                        <span>₱{{ taxes|floatformat:2 }}</span>
                    </div>
                    <div class="flex justify-between text-gray-700">
                        <span>Insurance:</span>
                        <span>₱{{ insurance|floatformat:2 }}</span>
                    </div>
                    <hr class="my-2 border-gray-300"/>
                    <div class="flex justify-between font-bold text-lg text-[#2975F7]">
                        <span class="">Total:</span>
                        <span>₱{{ total|floatformat:2 }}</span>
                    </div>
                </div>

                <!-- Contact Info -->
                <div class="bg-white rounded-xl shadow-md/50 p-6 space-y-2">
                    <h2 class="text-xl font-bold text-[#2975F7]"> Contact Info</h2>
                    {% if contact_info %}
                        <p><span class="font-semibold">Name:</span> {{ contact_info.first_name }} {{ contact_info.mi }} {{ contact_info.last_name }}</p>
                        <p><span class="font-semibold">Email:</span> {{ contact_info.email }}</p>
                        <p><span class="font-semibold">Phone:</span> {{ contact_info.number }}</p>
                    {% else %}
                        <p class="text-red-500">No contact info.</p>
                    {% endif %}
                </div>

                <!-- Payment Button -->
                 <div class="flex flex-col gap-2"> 
                        <a href="{% url 'bookingapp:select_seat' %}" class="w-full bg-gray-500 text-center hover:bg-gray-200 cursor-pointer text-white px-5 py-3 rounded-full shadow-md/50 font-semibold text-sm" >Back</a>
                    <form action="{% url 'bookingapp:confirm_booking' %}" method="POST" >
                        {% csrf_token %}
                        <button class="w-full bg-[#2975F7] hover:bg-[#2975F7]/90 cursor-pointer text-white px-5 py-3 rounded-full shadow-md/50 font-semibold text-sm">
                            Proceed to Payment 
                        </button>
                    </form>
                </div>
            </div>
        </div>

        </div>

    

   

    </div>

</main>
{% endblock %}
