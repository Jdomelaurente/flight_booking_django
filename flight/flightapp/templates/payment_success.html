{% extends "master.html" %}
{% block content %}
<h2>✅ Payment Successful!</h2>
<p>Your booking has been confirmed.</p> <br>

<h3>Booking Details</h3>
<p><strong>Booking ID:</strong> {{ booking.id }}</p>
<p><strong>Status:</strong> {{ booking.status }}</p>
<p><strong>Amount Paid:</strong> ₱{{ payment.amount }}</p> <br>

<h3>Price Breakdown (per leg)</h3>
<table border="1" cellpadding="8" cellspacing="0">
    <thead>
        <tr>
            <th>Flight</th>
            <th>Origin</th>
            <th>Destination</th>
            <th>Departure</th>
            <th>Seat</th>
            <th>Base Price</th>
            <th>Multiplier</th>
            <th>Factor</th>
            <th>Final Price</th>
        </tr>
    </thead>
    <tbody>
        {% for calc in calc_breakdown %}
        <tr>
            <td>{{ calc.schedule.flight.flight_number }}</td>
            <td>{{ calc.schedule.flight.route.origin_airport.code }}</td>
            <td>{{ calc.schedule.flight.route.destination_airport.code }}</td>
            <td>{{ calc.schedule.departure_time|date:"Y-m-d H:i" }}</td>
            <td>{{ calc.seat_name }}</td>
            <td>₱{{ calc.base_price }}</td>
            <td>×{{ calc.seat_multiplier }}</td>
            <td>
                {{ calc.booking_factor }}
                ({{ calc.days_diff }} day{% if calc.days_diff != 1 %}s{% endif %} before flight)
            </td>
            <td><strong>₱{{ calc.final_price }}</strong></td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<br>
<a href="{% url 'booking' %}">⬅ Back to Bookings</a>
{% endblock %}
